# Dictyostelium discoideum ゲノムアセンブリ・ポリッシングまとめ

本資料では、モデル生物 *Dictyostelium discoideum*（社会性アメーバ）のゲノムを、Oxford Nanopore Technologies（ONT）やIlluminaといった最新のDNAシーケンス技術を用いて解析し、高精度なゲノム配列を構築するプロジェクトの概要をまとめます。

**目的**：
本研究の目的は、「*Dictyostelium discoideum* の完全な染色体配列（ゲノム）を、できる限り正確に再構築（アセンブリ）し、構造的・配列的に高精度なゲノム配列を得ること」です。

これにより、細胞の分化や運動、シグナル伝達など多様な生物学的現象を理解するための基盤情報を提供します。

---

## 背景知識

**そもそも、なぜゲノムアセンブリが必要なのか？**
生物のゲノムとは、その生物の設計図にあたるDNAの全配列のことです。しかし、現代のシーケンサーはDNAを短く断片化して読み出すため、それを元に戻す「パズルの完成作業」が必要になります。これが**ゲノムアセンブリ**です。

**なぜDictyostelium discoideumなのか？**
このアメーバは、単細胞から多細胞に変化する不思議な性質を持ち、発生生物学や細胞の社会性の研究においてモデル生物として長年利用されてきました。

* 真核生物（ヒトと同じタイプの細胞構造）でありながら、構造が比較的シンプル
* ゲノムサイズが中程度（約34Mb）で、研究しやすい
* 古くから研究されており、既存の知識との照合が可能

---

## Dictyostelium discoideum ゲノムの概要

* **核染色体数**: 6本
* **rDNA（リボソームRNA遺伝子）**: 約88kbの領域が約100コピー存在し、染色体とは別に存在（**extrachromosomal palindrome** と呼ばれる構造）
* **ミトコンドリアDNA**: 約55.6kb、細胞内のエネルギー産生器官に対応
* **理想的なゲノム構成単位（リプリコン）数**: 6本の核染色体 + rDNA + ミトコンドリア = **合計8本**

---

### ゲノム配列の特徴と用語の解説

* **全長**: 約33.89 Mb（染色体アセンブリ：33.82 Mb、浮遊contig：69 kb）
  → 「Mb」は100万塩基（＝DNAの文字列の長さ）を意味します。
* **ギャップ総長**: 約15.6万bp。これは読み取れていない部分の「隙間」を意味します。
* **ATリッチ**: 塩基の77.57%がA（アデニン）+T（チミン）。
  → ヒトでは60%前後なのでかなりATに偏っています。
* **CpG欠乏**: 「CG」という組み合わせが少ない傾向にあります。これは、過去のメチル化や突然変異によるものと考えられています。
* **SSR（単純繰返し配列）**: 繰り返しが多い領域で、解析の難所になります。
* **tRNA遺伝子が非常に多い（390本）**：通常の真核生物より多く、タンデム重複（同じものが並んでコピーされる）しています。

---

## 使用データ

本解析では以下の2種類のDNAシーケンスデータを使用しています：

### 1. **ONTデータ（ロングリード）**

```bash
Dicty_gDNA_NEB-2.fastq
```

* 長い配列（最大13万塩基以上）を一度に読める。
* 繰り返しや構造の複雑な領域に強い。
* ただし、誤読が多く、正確な配列を得るにはポリッシング（後述）が必要。

### 2. **Illuminaデータ（ショートリード）**

```bash
Stationary_S1_R1.fastq.gz
Stationary_S1_R2.fastq.gz
```

* 数百塩基の短い配列を正確に大量に読み出せる。
* ロングリードの誤り訂正に使用。

### 3. **ONTサブセット**

```bash
Dicty_gDNA_NEB-2_half.fastq.gz
```

---

## ONTリード長分布の可視化

**リードとは？**
DNAシーケンサーは、ゲノム全体を一度に読み取ることができません。そのため、DNAを短い断片（リード）に分割して読み取り、後でこれらを組み合わせて全体の配列を再構築します。

**ONT（Oxford Nanopore Technologies）リードの特徴**
ONTは、長いDNA断片を読み取ることができるシーケンサーです。これにより、繰り返し領域や複雑な構造を持つゲノムの解析が容易になります。

**リード長分布の統計**

```bash
stats for Dicty_gDNA_NEB-2.fastq
sum = 8,359,638,019 bp
n = 934,886 リード
平均長 = 8,941.88 bp
最大長 = 139,714 bp
N50 = 12,777 bp
N60 = 10,380 bp
N70 = 8,415 bp
N80 = 6,569 bp
N90 = 4,537 bp
```

**用語解説**

* **N50**: リード長を長い順に並べたとき、全リード長の50%を占める最小のリード長。値が大きいほど、長いリードが多いことを示します。
* **平均長**: 全リードの平均長さ。
* **最大長**: 最も長いリードの長さ。

**図示**

![read-length](../public/read-length/image.png)

この図は、ONTリードの長さ分布を示しています。長いリードが多く含まれていることがわかります。

---

## アセンブリ手法

**アセンブリとは？**
リードを組み合わせて、元のゲノム配列を再構築するプロセスです。

**使用したアセンブリソフトウェア**

* **Flye**: 長いリードに特化したアセンブリソフト。
* **Canu**: 高精度なアセンブリが可能。
* **Raven**: 高速なアセンブリが特徴。
* **Shasta**: 超高速アセンブリが可能。

**評価指標（QUASTによる）**

| 指標        | Raven      | Flye       | Shasta     | Canu       |
| --------- | ---------- | ---------- | ---------- | ---------- |
| # contigs | 28         | 33         | 36         | 14         |
| 最大contig長 | 5,803,050  | 5,006,538  | 12,082,896 | 8,736,265  |
| 総長        | 35,504,430 | 34,319,985 | 33,471,541 | 34,572,512 |
| N50       | 2,694,088  | 2,870,802  | 6,719,217  | 3,611,137  |
| L50       | 5          | 5          | 2          | 3          |
| GC含量 (%)  | 22.77      | 22.98      | 22.90      | 23.06      |

**用語解説**

* **contig**: アセンブリされた連続したDNA配列。
* **N50**: contig長を長い順に並べたとき、全contig長の50%を占める最小のcontig長。
* **L50**: N50に対応するcontigの数。
* **GC含量**: ゲノム中のG（グアニン）とC（シトシン）の割合。

**考察**

* **Canu**は、最も少ないcontig数（14本）で、高いN50値を示し、バランスの取れたアセンブリ結果を提供しました。
* **Shasta**は、最大contig長とN50が最も大きいですが、contig数が多いです。
* **Flye**と**Raven**は、contig数が多く、N50もやや低いです。

---

## ポリッシング手法

**ポリッシングとは？**
アセンブリ後の配列に含まれる誤りを修正し、精度を向上させるプロセスです。

**使用したポリッシングツール**

* **Pilon**: Illuminaリードを使用して、アセンブリの誤りを修正。
* **Medaka**: ONTリードを使用して、アセンブリの誤りを修正。

**評価指標**

| 指標               | Pilon  | Medaka |
| ---------------- | ------ | ------ |
| ミスマッチ率 (/100kbp) | 128.52 | 134.82 |
| インデル率 (/100kbp)  | 233.45 | 188.91 |
| ゲノムフラクション (%)    | 97.182 | 97.190 |

**用語解説**

* **ミスマッチ率**: アセンブリとリファレンスゲノムとの間で一致しない塩基の割合。
* **インデル率**: 挿入や欠失の誤りの割合。
* **ゲノムフラクション**: アセンブリがリファレンスゲノムをどれだけカバーしているかの割合。

**考察**

* **Pilon**は、ミスマッチ率が低く、精度が高いですが、インデル率が高めです。
* **Medaka**は、インデル率が低く、ゲノムフラクションも高いですが、ミスマッチ率がやや高めです。

---

## 現状

* **contig数**: 14本（全てのポリッシング手法で一定）
* **目標**: 8本（6染色体 + rDNA + ミトコンドリア）
* **総配列長**: 約34.7～35.0 Mb（参照ゲノム: 34.2 Mb）
* **N50**: 約3.6 Mb（全ポリッシング手法で類似）
* **GC含量**: 22.79～23.06%（参照: 22.44%）

---

## 今後の方針

1. **他のポリッシングツールの検討**

   * **Homopolish**や**NextPolish**など、他のポリッシングツールを試し、精度向上を図る。
2. **Scaffoldingの導入**

   * **RaGOO**や**SSPACE**などのツールを使用して、contigを連結し、目標の8本に近づける。
3. **マルチアセンブリ戦略の検討**

   * 複数のアセンブリ結果を統合し、より高精度なゲノム配列を構築する。

---


