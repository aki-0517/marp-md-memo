# Dictyostelium discoideum ゲノムアセンブリ・ポリッシングまとめ

## 目次
- [Dictyostelium discoideum ゲノムアセンブリ・ポリッシングまとめ](#dictyostelium-discoideum-ゲノムアセンブリポリッシングまとめ)
  - [目次](#目次)
  - [背景知識](#背景知識)
    - [Dictyostelium discoideum ゲノムの概要](#dictyostelium-discoideum-ゲノムの概要)
      - [ゲノム配列の特徴](#ゲノム配列の特徴)
  - [使用データ](#使用データ)
  - [ONTリード長分布の可視化](#ontリード長分布の可視化)
    - [Data](#data)
  - [アセンブリ手法](#アセンブリ手法)
    - [Quastによる評価](#quastによる評価)
  - [ポリッシング手法](#ポリッシング手法)
  - [現状](#現状)
  - [今後の方針](#今後の方針)

## 背景知識

モデル生物 _Dictyostelium discoideum_ の高品質なゲノムアセンブリを確立することを目的とする。

- **核染色体数**: 6本
- **extrachromosomal palindrome（rDNA）**: 約88kbの線状パリンドロームが約100コピー、核DNAの約20%を占める
- **ミトコンドリアゲノム**: 約55.6kbが約200コピー
- **リプリコン数**: 6本の核染色体 + rDNAパリンドローム + ミトコンドリアゲノム = 計8本（理想的なcontig数）

---

### Dictyostelium discoideum ゲノムの概要

- **全長**: 約33.89 Mb（染色体アセンブリ：33,817,471 bp、浮遊コンティグ：69,589 bp）
- **染色体数**: 6本
- **カバレッジ**: 染色体1–6で9.1×～10.3×、全体平均8.3×
- **コンティグ数**: 染色体アセンブリ上309本（155箇所にギャップ）、浮遊コンティグ34本
- **ギャップ総推定長**: 155,750 bp（配列ギャップ・リピートギャップ・クローンギャップ含む）
- **組み立て手法**: Whole-Chromosome Shotgun（WCS）＋HAPPYマッピング（3,902マーカー、平均8.7 kb間隔）

#### ゲノム配列の特徴
- **ATリッチ**: 全ゲノムの77.57%がA+T（G+Cは22.43%）
- **CpG欠乏**: CpG頻度はGpCの62%、シトシンのメチル化が示唆される
- **単純繰返し配列（SSR）**: ゲノム塩基の>11%（非コーディング領域で特に高頻度、ホモポリマーも多い）
- **トランスポゾン**: 非LTRレトロトランスポゾンが多数、tRNA近傍への挿入が多い
- **tRNA遺伝子**: 390本（真核生物として上位）、全感覚コドンをほぼ網羅、tandem duplicationが多い

## 使用データ

- ONT: `Dicty_gDNA_NEB-2.fastq`
- Illumina: `./Dicty-genome/Stationary_S1_R1.fastq.gz`, `./Dicty-genome/Stationary_S1_R2.fastq.gz`
- サブセット: `Dicty_gDNA_NEB-2_half.fastq.gz`

## ONTリード長分布の可視化

### Data

- ONT

```bash
stats for Dicty_gDNA_NEB-2.fastq
sum = 8359638019, n = 934886, ave = 8941.88, largest = 139714
N50 = 12777, n = 188908
N60 = 10380, n = 261703
N70 = 8415, n = 351177
N80 = 6569, n = 463244
N90 = 4537, n = 614607
N100 = 19, n = 934886
N_count = 0
Gaps = 0
```

![read-length](../public/read-length/image.png)


※ 現在のプロジェクトはDictyostelium discoideumのゲノムアセンブリに焦点を当てており、ONTデータが主要なシーケンスデータとして使用されています。

## アセンブリ手法

- **Flye**
- **Canu**
- **Raven**
- **Shasta**

### Quastによる評価

| 指標                | Raven   | Flye    | Shasta   | Canu     |
|---------------------|---------|---------|----------|----------|
| # contigs           | 28      | 33      | 36       | 14       |
| Largest contig      | 5,803,050 | 5,006,538 | 12,082,896 | 8,736,265 |
| Total length        | 35,504,430 | 34,319,985 | 33,471,541 | 34,572,512 |
| N50                 | 2,694,088 | 2,870,802 | 6,719,217 | 3,611,137 |
| L50                 | 5       | 5       | 2        | 3        |
| GC (%)              | 22.77   | 22.98   | 22.90    | 23.06    |

- Canuはcontig数が最も少なく（14本）、N50や最大長も高水準で、全体のバランスが良い。
- Shastaは最大contig長・N50が最も大きいが、contig数が多い。
- FlyeやRavenはcontig数が多く、N50もやや低い。

→ 総合的にCanuが最も精度が高いと判断される。

## ポリッシング手法

- **Pilon**（ONT, Illuminaリードで2ラウンド）
  - 精度向上は限定的
  - ミスマッチ率: 128.52/100kbp
  - インデル率: 233.45/100kbp
  - ゲノムフラクション: 97.182%
- **Medaka**（ONTリードで1ラウンド）
  - ミスマッチ率: 134.82/100kbp
  - インデル率: 188.91/100kbp
  - ゲノムフラクション: 97.190%

## 現状

- contig数: 14（全てのポリッシング手法で一定）
- 目標: 8（6染色体+1rDNA+1ミトコンドリア）
- 現状: Canu → Pilon（ONT50%）→ Pilon（Illumina50%）→ Medaka（ONT）の順でポリッシング
- 総配列長: ~34.7-35.0 Mb（参照ゲノム: 34.2 Mb）
- N50: ~3.6 Mb（全ポリッシング手法で類似）
- GC含量: 22.79-23.06%（参照: 22.44%）

## 今後の方針

1. **他のライブラリでpolishingを試す**
   - Pilon、Medaka以外のpolishingツールやパラメータを検討
1. **Scaffoldingでcontig数削減を目指す**
   - ベストなアセンブリ結果をもとにscaffoldingツールを適用し、目標の8本に近づける
3. **マルチアセンブリ戦略の検討**
   - 切れ目の異なる複数アセンブリを統合し、より長いcontigを目指す
