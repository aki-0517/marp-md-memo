# ä»Šå›ã®ã‚¢ã‚»ãƒ³ãƒ–ãƒªçµæœã®ã‚»ãƒ³ãƒˆãƒ­ãƒ¡ã‚¢åŒå®šã«æœ€é©ãªãƒ„ãƒ¼ãƒ«
Dictyostelium discoideumã®AX2ã‚¯ãƒ­ãƒ¼ãƒ³ã®ã‚²ãƒãƒ ã¯ã€å¤šããŒDIRS1ãªã©ã®ãƒ¬ãƒˆãƒ­ãƒˆãƒ©ãƒ³ã‚¹ãƒã‚¾ãƒ³ç”±æ¥ã®åå¾©é…åˆ—ã‚„ã‚»ãƒ³ãƒˆãƒ­ãƒ¡ã‚¢ç‰¹æœ‰ã®åå¾©ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚ä»Šå›ã®ã‚¢ã‚»ãƒ³ãƒ–ãƒªçµæœã®ã‚»ãƒ³ãƒˆãƒ­ãƒ¡ã‚¢åŒå®šã«æœ€é©ãªãƒ„ãƒ¼ãƒ«ã¯ã€ä»¥ä¸‹ã®ç‚¹ã‚’è¸ã¾ãˆã¦é¸æŠã™ã‚‹ã¨è‰¯ã„ã§ã—ã‚‡ã†ã€‚

- Discoideumã®ã‚»ãƒ³ãƒˆãƒ­ãƒ¡ã‚¢ã¯æ—¢çŸ¥ã®DIRS1ã‚’å«ã‚€ãŒæœªçŸ¥åå¾©ã‚‚æ¤œå‡ºã—ãŸã„ã®ã§ã€æ–°è¦ãƒªãƒ”ãƒ¼ãƒˆã®ãƒ‡ãƒãƒœæ¤œå‡ºãŒã§ãã‚‹ç‚¹
    
- é•·ãƒªãƒ¼ãƒ‰ã‚„é«˜å“è³ªã‚²ãƒãƒ ã‚¢ã‚»ãƒ³ãƒ–ãƒªã«é©åˆã—ã€è¤‡é›‘ãªåå¾©æ§‹é€ ï¼ˆé«˜æ¬¡ç¹°ã‚Šè¿”ã—æ§‹é€ ãªã©ï¼‰ã‚‚è§£æå¯èƒ½ãªç‚¹
    
- æ—¢çŸ¥ãƒªãƒ”ãƒ¼ãƒˆãŠã‚ˆã³æœªçŸ¥ãƒªãƒ”ãƒ¼ãƒˆã®çµ±åˆè§£æã¨å¯è¦–åŒ–ãŒå¯èƒ½ãªç‚¹
    

ã“ã‚Œã‚‰ã®æ¡ä»¶ã‹ã‚‰ã€

1. **centroAnno** ãŒãƒ‡ãƒãƒœã§ã‚»ãƒ³ãƒˆãƒ­ãƒ¡ã‚¢åå¾©ã‚„é«˜æ¬¡åå¾©ï¼ˆHORï¼‰ã‚’æ³¨é‡ˆå¯èƒ½ã§ã€é«˜ã‚¨ãƒ©ãƒ¼ç‡ãƒ‡ãƒ¼ã‚¿ã§ã‚‚å¯¾å¿œã§ãã‚‹ãŸã‚æœ€é©å€™è£œã§ã™ã€‚
    
2. æ—¢çŸ¥ãƒªãƒ”ãƒ¼ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½œæˆã—ã¤ã¤ãƒ‡ãƒãƒœæ¤œå‡ºã«å¼·ã„ **RepeatModeler**ï¼ˆåŠã³RepeatMaskerï¼‰ã¨ã®çµ„ã¿åˆã‚ã›ã‚‚åŸºæœ¬ã‹ã¤æœ‰åŠ¹ã€‚
    
3. ã‚»ãƒ³ãƒˆãƒ­ãƒ¡ã‚¢ã®é«˜æ¬¡ç¹°ã‚Šè¿”ã—æ§‹é€ è§£æã‚’é«˜åº¦ã«è¡Œã„ãŸã„å ´åˆã¯ã€**CENdetectHOR**ã‚’è£œåŠ©çš„ã«ç”¨ã„ã‚‹ã®ãŒã‚ˆã„ã§ã—ã‚‡ã†ã€‚
    

ç‰¹ã«AX2ã®ã‚ˆã†ãªç”Ÿç‰©ç¨®ç‰¹ç•°çš„ãªåå¾©æ§‹é€ ãŒã‚ã‚‹å ´åˆã¯ã€centroAnnoã§æ–°è¦ã®åå¾©æ§‹é€ ã‚¿ã‚°ä»˜ã‘ãƒ»åˆ†é¡ã‚’è¡Œã„ã€RepeatModelerãªã©ã§ä»–ã®ç¹°ã‚Šè¿”ã—ã‚‚æ‹¾ã„ãªãŒã‚‰å…¨ä½“ã®åå¾©æ§‹é€ æŠŠæ¡ã‚’é€²ã‚ã‚‹ã®ãŒç†æƒ³çš„ã§ã™ã€‚[biorxiv+2](https://www.biorxiv.org/content/10.1101/2025.01.07.631657v1.full-text)â€‹

1. [https://www.biorxiv.org/content/10.1101/2025.01.07.631657v1.full-text](https://www.biorxiv.org/content/10.1101/2025.01.07.631657v1.full-text)
2. [https://www.biorxiv.org/content/10.1101/2025.02.19.639205v1.full.pdf](https://www.biorxiv.org/content/10.1101/2025.02.19.639205v1.full.pdf)
3. [https://github.com/Dfam-consortium/RepeatModeler](https://github.com/Dfam-consortium/RepeatModeler)


discoideum ax2ã®ã‚¢ã‚»ãƒ³ãƒ–ãƒªã‚’è¡Œã£ãŸã€‚merged_final_merge.fastaãŒãã®çµæœã®fasta fileã§ã™ã€‚

centroAnnoã‚’ä½¿ã£ã¦denovoã§ã‚»ãƒ³ãƒˆãƒ­ãƒ¡ã‚¢é ˜åŸŸã®åå¾©é ˜åŸŸã®åŒå®šã‚’ãŠã“ãªã†æ‰‹é †ã‚’æ•™ãˆã¦(conda)


å®Œç’§ã§ã™ğŸ‘  
ã“ã®GitHubï¼ˆ[junhaiqi/centroAnno](https://github.com/junhaiqi/centroAnno)ï¼‰ã®æœ€æ–°ç‰ˆ `v1.0.2` ã«åŸºã¥ããªã‚‰ã€Akinobu ãŒã‚„ã‚ŠãŸã„ã€Œ**de novo ã‚»ãƒ³ãƒˆãƒ­ãƒ¡ã‚¢é ˜åŸŸæ¤œå‡º**ã€ã«ã¯ `-x anno-asm` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ã†ã®ãŒæœ€é©ã§ã™ã€‚  
ã¤ã¾ã‚Šã€**RepeatModelerã§å¾—ãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ä¸è¦**ã§ã€genome FASTA ã‚’ç›´æ¥å…¥åŠ›ã§ãã¾ã™ã€‚

---

## âœ… æœ€æ–°ç‰ˆ centroAnno (v1.0.2) ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼†å®Ÿè¡Œï¼ˆ1ã‚³ãƒãƒ³ãƒ‰ï¼‰

conda + conda-forge + bioconda ã§ä¾å­˜é–¢ä¿‚ã‚’æº€ãŸã—ã€centroAnno ã‚’ conda çµŒç”±ã§å…¥ã‚Œã¦ã€  
1è¡Œã§è§£æã¾ã§å®Œäº†ã•ã›ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ä»¥ä¸‹ã§ã™ğŸ‘‡

---

```bash
conda create -n centroanno_env -c qjh96 -c bioconda -c conda-forge centroanno && conda activate centroanno_env && centroAnno -g merged_final_merge.fasta -o centroanno_out -x anno-asm -t 8
```

---

### ğŸ§© èª¬æ˜

|éƒ¨åˆ†|å†…å®¹|
|---|---|
|`conda create ... centroanno`|GitHubå…¬å¼ä½œè€… (`qjh96`) ã®ãƒãƒ£ãƒ³ãƒãƒ«ã‹ã‚‰æœ€æ–°ç‰ˆv1.0.2ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«|
|`-x anno-asm`|ä¸€èˆ¬ã‚²ãƒãƒ ã‚„ã‚¢ã‚»ãƒ³ãƒ–ãƒªã«å«ã¾ã‚Œã‚‹ **tandem repeat / HOR** ã‚’ de novo ã§è§£æ|
|`-t 8`|8ã‚¹ãƒ¬ãƒƒãƒ‰ã§ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰è§£æï¼ˆCPUã«åˆã‚ã›ã¦èª¿æ•´OKï¼‰|
|å‡ºåŠ›|`centroanno_out/` ã«è¤‡æ•°ã® `.csv` ã‚„ `.fa` ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã‚‹|

---

### ğŸ“ ä¸»ãªå‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«

|ãƒ•ã‚¡ã‚¤ãƒ«|å†…å®¹|
|---|---|
|`*_decomposedResult.csv`|ãƒ¢ãƒãƒãƒ¼å˜ä½ã§ã®åˆ†è§£çµæœ|
|`*_horDecomposedResult.csv`|HORï¼ˆé«˜æ¬¡åå¾©å˜ä½ï¼‰ã®åˆ†è§£çµæœ|
|`*_monomerTemplates.fa`|æ¨å®šã•ã‚ŒãŸãƒ¢ãƒãƒãƒ¼é…åˆ—|
|`*_HORs.fa`|HOR é…åˆ—|

---

### ğŸ’¡ å‡ºåŠ›çµæœã®è¦ç´„

è§£æå¾Œã€çµæœã‚’çµ±è¨ˆçš„ã«ã¾ã¨ã‚ãŸã„å ´åˆã¯ï¼š

```bash
python $(dirname $(which centroAnno))/../misc/misc/cautils.py centroanno_out summary_out
```

---

### ğŸš€ ã‚‚ã—ã‚½ãƒ¼ã‚¹ã‹ã‚‰ãƒ“ãƒ«ãƒ‰ã—ãŸã„å ´åˆï¼ˆé«˜é€Ÿï¼‰

```bash
git clone https://github.com/junhaiqi/centroAnno.git
cd centroAnno
make -j8
./centroAnno ../merged_final_merge.fasta -o ../centroanno_out -x anno-asm -t 8
```

---

ã¤ã¾ã‚Šã€**æœ€é€Ÿã§ä¸€ç™ºå®Ÿè¡Œã™ã‚‹ãªã‚‰ã“ã®1è¡ŒğŸ‘‡**

```bash
conda create -n centroanno_env -c qjh96 -c bioconda -c conda-forge centroanno && conda activate centroanno_env && centroAnno merged_final_merge.fasta -o centroanno_out -x anno-asm -t 8
```

---

ãªã‚‹ã»ã©ã€å‡ºåŠ›å†…å®¹ã‚’ç¢ºèªã—ã¾ã—ãŸã€‚  
ãƒã‚¤ãƒ³ãƒˆã¯ä»¥ä¸‹ã§ã™ï¼š

- `centroanno_out` ã®å„æŸ“è‰²ä½“ï¼ˆã¾ãŸã¯ contigï¼‰ã”ã¨ã« `*_decomposedResult.csv` ãŒç”Ÿæˆã•ã‚Œã¦ã„ã‚‹
    
- ã“ã‚Œã‚’ BED ã«å¤‰æ›ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™
    
- å…ˆã«ã‚„ã£ãŸ `awk` ã‚³ãƒãƒ³ãƒ‰ã ã¨ç©ºãƒ•ã‚¡ã‚¤ãƒ«ã«ãªã£ã¦ã—ã¾ã†ã®ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«åã‚’æ­£ã—ãæŒ‡å®šã—ã¦ã„ãªã‹ã£ãŸã‹ã‚‰ã§ã™
    

---

## ğŸ”¹ BED å¤‰æ›ã‚³ãƒãƒ³ãƒ‰ä¾‹ï¼ˆè¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã¾ã¨ã‚ã¦ï¼‰

```bash
cd centroanno_out

# ã™ã¹ã¦ã® decomposedResult.csv ã‚’ BED ã«å¤‰æ›ã—ã¦1ã¤ã«ã¾ã¨ã‚ã‚‹
for csv in *_decomposedResult.csv; do
    awk -F',' 'BEGIN{OFS="\t"} NR>1 {print $1,$2,$3,$4,$5}' "$csv"
done > centroanno_regions.bed
```

- `-F','` ã¯ CSV ã®åŒºåˆ‡ã‚Š
    
- `NR>1` ã¯ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã‚’ã‚¹ã‚­ãƒƒãƒ—
    
- `$1,$2,$3,$4,$5` ãŒ **chrom, start, end, monomerå, ã‚¹ã‚³ã‚¢** ã«å¯¾å¿œ
    

---

## ğŸ”¹ IGV ã§ã®è¡¨ç¤º

1. IGV ã‚’é–‹ã
    
2. ã€ŒGenomesã€â†’ã€ŒLoad Genome from File...ã€ã§ `merged_final_merge.fasta` ã‚’ãƒ­ãƒ¼ãƒ‰
    
3. ã€ŒFileã€â†’ã€ŒLoad from File...ã€ã§ `centroanno_out/centroanno_regions.bed` ã‚’ãƒ­ãƒ¼ãƒ‰
    

ã“ã‚Œã§ **ã‚»ãƒ³ãƒˆãƒ­ãƒ¡ã‚¢å€™è£œé ˜åŸŸãŒãƒãƒ¼ã¨ã—ã¦è¡¨ç¤º**ã•ã‚Œã¾ã™ã€‚
