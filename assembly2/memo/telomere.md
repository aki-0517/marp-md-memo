ãƒ†ãƒ­ãƒ¡ã‚¢é…åˆ—ã¨ã¯ã€**æŸ“è‰²ä½“ã®æœ«ç«¯ã«ã‚ã‚‹ã€Œãƒ•ã‚¿ã€ã®ã‚ˆã†ãªæ§‹é€ ï¼ˆãƒ†ãƒ­ãƒ¡ã‚¢ï¼‰ã‚’æ§‹æˆã™ã‚‹ã€ç‰¹å¾´çš„ãªDNAé…åˆ—**ã®ã“ã¨ã§ã™ã€‚

ã“ã®é…åˆ—ã¯ã€ç‰¹å®šã®çŸ­ã„å¡©åŸºé…åˆ—ãŒä½•åƒå›ã‚‚ç¹°ã‚Šè¿”ã•ã‚Œã¦ã„ã‚‹ã€Œåå¾©é…åˆ—ã€ã§ã™ã€‚ãƒ’ãƒˆã®å ´åˆã€ãƒ†ãƒ­ãƒ¡ã‚¢é…åˆ—ã¯ã€Œ**TTAGGG**ã€ã¨ã„ã†6ã¤ã®å¡©åŸºã®çµ„ã¿åˆã‚ã›ãŒç¹°ã‚Šè¿”ã•ã‚Œã¦ã„ã¾ã™ã€‚



---

### ãƒ†ãƒ­ãƒ¡ã‚¢é…åˆ—ã®é‡è¦ãªå½¹å‰²

ãƒ†ãƒ­ãƒ¡ã‚¢é…åˆ—ã¯ã€é´ã²ã‚‚ã®å…ˆç«¯ã«ã‚ã‚‹ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯ã®ã‚­ãƒ£ãƒƒãƒ—ã«ã‚ˆãä¾‹ãˆã‚‰ã‚Œã¾ã™ã€‚ã“ã®ã‚­ãƒ£ãƒƒãƒ—ãŒã‚ã‚‹ãŠã‹ã’ã§ã€é´ã²ã‚‚ã¯ã»ã¤ã‚Œãšã«ãã®å½¹ç›®ã‚’æœãŸã›ã¾ã™ã€‚ãƒ†ãƒ­ãƒ¡ã‚¢ã‚‚åŒæ§˜ã«ã€æŸ“è‰²ä½“ã«ã¨ã£ã¦ä¸å¯æ¬ ãª2ã¤ã®é‡è¦ãªå½¹å‰²ã‚’æ‹…ã£ã¦ã„ã¾ã™ã€‚

#### 1. éºä¼æƒ…å ±ã®ä¿è­·
ç´°èƒãŒåˆ†è£‚ã™ã‚‹éš›ã€æŸ“è‰²ä½“ã‚‚è¤‡è£½ã•ã‚Œã¾ã™ã€‚ã—ã‹ã—ã€è¤‡è£½ã®ä»•çµ„ã¿ä¸Šã€æŸ“è‰²ä½“ã®æœ«ç«¯ã¯æ¯å›å°‘ã—ãšã¤çŸ­ããªã£ã¦ã—ã¾ã„ã¾ã™ã€‚ãƒ†ãƒ­ãƒ¡ã‚¢é…åˆ—ã¯éºä¼æƒ…å ±ã‚’å«ã¾ãªã„ã€Œæ¨ã¦çŸ³ã€ã®ã‚ˆã†ãªéƒ¨åˆ†ãªã®ã§ã€ã“ã®éƒ¨åˆ†ãŒä»£ã‚ã‚Šã«çŸ­ããªã‚‹ã“ã¨ã§ã€**å†…å´ã«ã‚ã‚‹é‡è¦ãªéºä¼æƒ…å ±ãŒå‰Šã‚‰ã‚Œã¦ã—ã¾ã†ã®ã‚’é˜²ã„ã§ã„ã¾ã™ã€‚**

#### 2. æŸ“è‰²ä½“ã®å®‰å®šåŒ–
ã‚‚ã—æŸ“è‰²ä½“ã®æœ«ç«¯ãŒã‚€ãå‡ºã—ã«ãªã£ã¦ã„ã‚‹ã¨ã€ç´°èƒã¯ãã‚Œã‚’ã€Œå£Šã‚ŒãŸDNAã€ã¨å‹˜é•ã„ã—ã¦ã€ä»–ã®æŸ“è‰²ä½“ã¨ãã£ã¤ã‘ã¦ã—ã¾ã†ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ãƒ†ãƒ­ãƒ¡ã‚¢é…åˆ—ãŒæœ«ç«¯ã‚’è¦†ã£ã¦ã„ã‚‹ã“ã¨ã§ã€**æŸ“è‰²ä½“ã©ã†ã—ã®ç•°å¸¸ãªèåˆã‚’é˜²ãã€ã‚²ãƒãƒ å…¨ä½“ã®å®‰å®šæ€§ã‚’ä¿ã£ã¦ã„ã¾ã™ã€‚**

### ãƒ†ãƒ­ãƒ¡ã‚¢ã¨ã€Œè€åŒ–ã€ã€ŒãŒã‚“ã€ã®é–¢ä¿‚
ç´°èƒåˆ†è£‚ã®ãŸã³ã«ãƒ†ãƒ­ãƒ¡ã‚¢ã¯çŸ­ããªã‚‹ãŸã‚ã€**ãƒ†ãƒ­ãƒ¡ã‚¢ã®é•·ã•ã¯ã€Œç´°èƒã®å¯¿å‘½ã®å›æ•°åˆ¸ã€**ã¨ã‚‚è¨€ã‚ã‚Œã¾ã™ã€‚ãƒ†ãƒ­ãƒ¡ã‚¢ãŒä¸€å®šã®çŸ­ã•ã«é”ã™ã‚‹ã¨ã€ç´°èƒã¯ãã‚Œä»¥ä¸Šåˆ†è£‚ã§ããªããªã‚Šã€ã€Œç´°èƒè€åŒ–ã€ã¨ã„ã†çŠ¶æ…‹ã«ãªã‚Šã¾ã™ã€‚ã“ã‚ŒãŒå€‹ä½“ã®è€åŒ–ã®ä¸€å› ã¨è€ƒãˆã‚‰ã‚Œã¦ã„ã¾ã™ã€‚

ä¸€æ–¹ã§ã€ãŒã‚“ç´°èƒã®å¤šãã¯ã€Œãƒ†ãƒ­ãƒ¡ãƒ©ãƒ¼ã‚¼ã€ã¨ã„ã†ç‰¹æ®Šãªé…µç´ ã‚’æ´»æ€§åŒ–ã•ã›ã€çŸ­ããªã£ãŸãƒ†ãƒ­ãƒ¡ã‚¢ã‚’ä¿®å¾©ã—ã¦ç„¡é™ã«åˆ†è£‚ã—ç¶šã‘ã‚‹èƒ½åŠ›ã‚’ç²å¾—ã—ã¦ã„ã¾ã™ã€‚ã“ã®ãŸã‚ã€ãƒ†ãƒ­ãƒ¡ã‚¢ã‚„ãƒ†ãƒ­ãƒ¡ãƒ©ãƒ¼ã‚¼ã¯ã€è€åŒ–ã‚„ãŒã‚“ã®ç ”ç©¶ã«ãŠã„ã¦éå¸¸ã«é‡è¦ãªã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¨ãªã£ã¦ã„ã¾ã™ã€‚

_Dictyostelium discoideum_ã®ã‚²ãƒãƒ ã«é–¢ã™ã‚‹è«–æ–‡ã«ã‚ˆã‚‹ã¨ã€ã“ã®ç”Ÿç‰©ã¯ä»–ã®å¤šãã®çœŸæ ¸ç”Ÿç‰©ã§è¦‹ã‚‰ã‚Œã‚‹å…¸å‹çš„ãªãƒ†ãƒ­ãƒ¡ã‚¢é…åˆ—ã‚’æŒã£ã¦ã„ã¾ã›ã‚“ã€‚ä»£ã‚ã‚Šã«ã€æŸ“è‰²ä½“ã®æœ«ç«¯ã«ã¯ã€æŸ“è‰²ä½“å¤–ãƒªãƒœã‚½ãƒ¼ãƒ DNAï¼ˆrDNAï¼‰ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆã®æœ«ç«¯ã«è¦‹ã‚‰ã‚Œã‚‹ã®ã¨åŒã˜**(G+A)ã«å¯Œã‚€ãƒªãƒ”ãƒ¼ãƒˆãƒ¢ãƒãƒ¼ãƒ•**ãŒå­˜åœ¨ã—ã¾ã™ 1111ã€‚

---

### ãƒ†ãƒ­ãƒ¡ã‚¢æ§‹é€ ã®ç‰¹å¾´

ã“ã®ç ”ç©¶ã§ã¯ã€å…¸å‹çš„ãª(G+T)ã«å¯Œã‚€ãƒ†ãƒ­ãƒ¡ã‚¢æ§˜ã®ãƒ¢ãƒãƒ¼ãƒ•ã¯ã‚²ãƒãƒ é…åˆ—ä¸­ã«è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ 2ã€‚ãã®ä»£ã‚ã‚Šã€ä»¥ä¸‹ã®ç‚¹ãŒæ˜ã‚‰ã‹ã«ãªã‚Šã¾ã—ãŸã€‚

- **rDNAé…åˆ—ã®åˆ©ç”¨**: æŸ“è‰²ä½“ã®æœ«ç«¯ã«ã¯ã€æŸ“è‰²ä½“å¤–ã«å¤šæ•°å­˜åœ¨ã™ã‚‹rDNAãƒ‘ã‚¤ãƒ³ãƒ‰ãƒ­ãƒ¼ãƒ ã®éƒ¨åˆ†çš„ãªã‚³ãƒ”ãƒ¼ãŒå­˜åœ¨ã—ã€ã“ã‚ŒãŒãƒ†ãƒ­ãƒ¡ã‚¢ã¨ã—ã¦æ©Ÿèƒ½ã—ã¦ã„ã‚‹ã¨è€ƒãˆã‚‰ã‚Œã¦ã„ã¾ã™ 3333ã€‚
    
- **æœ«ç«¯æ§‹é€ **: æŸ“è‰²ä½“ã®æœ«ç«¯é ˜åŸŸã¨rDNAæ§˜é…åˆ—ã¨ã®æ¥åˆéƒ¨ãŒ12ç®‡æ‰€ç¢ºèªã•ã‚Œã¦ãŠã‚Šã€ã“ã‚Œã‚‰ãŒå„æŸ“è‰²ä½“ã®æœ«ç«¯ï¼ˆãƒ†ãƒ­ãƒ¡ã‚¢ï¼‰ã§ã‚ã‚‹ã¨çµè«–ä»˜ã‘ã‚‰ã‚Œã¦ã„ã¾ã™ 4444ã€‚
    
- **å…±é€šã®ç¶­æŒæ©Ÿæ§‹**: ã“ã®æ§‹é€ ã¯ã€æŸ“è‰²ä½“ã®æœ«ç«¯ã¨æŸ“è‰²ä½“å¤–rDNAã®ä¸¡æ–¹ã‚’ç¶­æŒãƒ»å®‰å®šåŒ–ã•ã›ã‚‹ãŸã‚ã«ã€å…±é€šã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ãŒç”¨ã„ã‚‰ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ã‚’ç¤ºå”†ã—ã¦ã„ã¾ã™ 5ã€‚
    

è¦ç´„ã™ã‚‹ã¨ã€_Dictyostelium_ã¯ä¸€èˆ¬çš„ãªãƒ†ãƒ­ãƒ¡ã‚¢é…åˆ—ï¼ˆä¾‹ï¼šãƒ’ãƒˆã®TTAGGGï¼‰ã‚’æŒãŸãšã€ãƒªãƒœã‚½ãƒ¼ãƒ DNAã®æœ«ç«¯é…åˆ—ã‚’æŸ“è‰²ä½“ã®ãƒ†ãƒ­ãƒ¡ã‚¢ã¨ã—ã¦åˆ©ç”¨ã™ã‚‹ã¨ã„ã†ã€éå¸¸ã«ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªæ§‹é€ ã‚’æŒã£ã¦ã„ã¾ã™ã€‚

ã¯ã„ã€æ‰¿çŸ¥ã„ãŸã—ã¾ã—ãŸã€‚ã‚¢ã‚»ãƒ³ãƒ–ãƒªå¾Œã®FASTAãƒ•ã‚¡ã‚¤ãƒ« (`ragtag_polished_round1.fasta`) ã‹ã‚‰ã€ãƒªãƒœã‚½ãƒ¼ãƒ DNA (rDNA) ã®æœ«ç«¯ã«ã‚ã‚‹åå¾©é…åˆ—ï¼ˆãƒ†ãƒ­ãƒ¡ã‚¢æ§˜é…åˆ—ï¼‰ã‚’ç‰¹å®šã™ã‚‹ãŸã‚ã®ã‚³ãƒãƒ³ãƒ‰æ‰‹é †ã‚’ã€æ®µéšçš„ã«è§£èª¬ã—ã¾ã™ã€‚

ã“ã®æ‰‹é †ã¯ã€æ—¢çŸ¥ã®

_Dictyostelium discoideum_ã®rDNAé…åˆ—ã‚’ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã¨ã—ã¦ä½¿ç”¨ã—ã€ã‚ãªãŸã®ã‚¢ã‚»ãƒ³ãƒ–ãƒªãƒ‡ãƒ¼ã‚¿ã‹ã‚‰è©²å½“ã™ã‚‹é ˜åŸŸã‚’è¦‹ã¤ã‘å‡ºã—ã€ãã®æœ«ç«¯ã‚’è§£æã™ã‚‹ã¨ã„ã†æµã‚Œã«åŸºã¥ã„ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯ã€_Dictyostelium_ã®ãƒ†ãƒ­ãƒ¡ã‚¢ãŒrDNAã®æœ«ç«¯åå¾©é…åˆ—ã«ã‚ˆã£ã¦æ§‹æˆã•ã‚Œã¦ã„ã‚‹ã¨ã„ã†ç”Ÿç‰©å­¦çš„çŸ¥è¦‹ã‚’åˆ©ç”¨ã—ãŸã‚¢ãƒ—ãƒ­ãƒ¼ãƒã§ã™ 1111ã€‚

---

### å¿…è¦ãªãƒ„ãƒ¼ãƒ«

ã‚ã‚‰ã‹ã˜ã‚ã€ä»¥ä¸‹ã®ãƒã‚¤ã‚ªã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹ãƒ„ãƒ¼ãƒ«ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã€ãƒ‘ã‚¹ãŒé€šã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

- **BLAST+**: `blastn`, `makeblastdb` ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
    
- **Samtools**: `samtools faidx` ã‚³ãƒãƒ³ãƒ‰ã§ç‰¹å®šã®é…åˆ—ã‚’æŠ½å‡ºã—ã¾ã™ã€‚
    
- **Entrez Direct (EDirect)**: NCBIã‹ã‚‰ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹é…åˆ—ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã—ã¾ã™ï¼ˆæ¨å¥¨ï¼‰ã€‚
    
- **Tandem Repeats Finder (TRF)**: é…åˆ—ä¸­ã®ç¸¦åˆ—åå¾©é…åˆ—ã‚’æ¤œå‡ºã™ã‚‹ãŸã‚ã®å°‚é–€ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
    

---

### ã‚¹ãƒ†ãƒƒãƒ—1ï¼šãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹rDNAé…åˆ—ã®æº–å‚™

ã¾ãšã€æ¤œç´¢ã®å…ƒã¨ãªã‚‹_Dictyostelium discoideum_ã®å®Œå…¨ãªæŸ“è‰²ä½“å¤–rDNAé…åˆ—ã‚’NCBIã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚

Bash

```
# EDirectã‚’ä½¿ã£ã¦ã‚¢ã‚¯ã‚»ãƒƒã‚·ãƒ§ãƒ³ç•ªå· M11158 ã®é…åˆ—ã‚’å–å¾—ã™ã‚‹
efetch -db nucleotide -id M11158 -format fasta > dicty_rDNA_ref.fasta

# å–å¾—ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
head dicty_rDNA_ref.fasta
```

**ã‚³ãƒãƒ³ãƒ‰è§£èª¬**:

- `efetch`: NCBIã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚
    
- `-db nucleotide -id M11158 -format fasta`: ãƒŒã‚¯ãƒ¬ã‚ªãƒãƒ‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰æŒ‡å®šã—ãŸã‚¢ã‚¯ã‚»ãƒƒã‚·ãƒ§ãƒ³ç•ªå·ã®ãƒ‡ãƒ¼ã‚¿ã‚’FASTAå½¢å¼ã§å–å¾—ã—ã¾ã™ã€‚
    
- `> dicty_rDNA_ref.fasta`: å–å¾—ã—ãŸçµæœã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã—ã¾ã™ã€‚
    

---

### ã‚¹ãƒ†ãƒƒãƒ—2ï¼šBLASTã«ã‚ˆã‚‹rDNAã‚³ãƒ³ãƒ†ã‚£ã‚°ã®ç‰¹å®š

æ¬¡ã«ã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹é…åˆ—ã‚’ã‚¯ã‚¨ãƒªã¨ã—ã¦ã€ã‚ãªãŸã®ã‚²ãƒãƒ ã‚¢ã‚»ãƒ³ãƒ–ãƒªã«å¯¾ã—ã¦BLASTæ¤œç´¢ã‚’å®Ÿè¡Œã—ã€rDNAã‚’å«ã‚€ã‚³ãƒ³ãƒ†ã‚£ã‚°ï¼ˆã¾ãŸã¯ã‚¹ã‚«ãƒ•ã‚©ãƒ¼ãƒ«ãƒ‰ï¼‰ã‚’ç‰¹å®šã—ã¾ã™ã€‚

Bash

```
# 1. ã‚ãªãŸã®ã‚¢ã‚»ãƒ³ãƒ–ãƒªãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰BLASTãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆ
makeblastdb -in ragtag_polished_round1.fasta -dbtype nucl -out my_assembly_db

# 2. blastnã‚’å®Ÿè¡Œã—ã¦ã€ã‚¢ã‚»ãƒ³ãƒ–ãƒªå†…ã®rDNAé…åˆ—ã‚’æ¤œç´¢
blastn -query dicty_rDNA_ref.fasta -db my_assembly_db -outfmt 6 -out blast_results.txt

# 3. BLASTã®çµæœã‚’ç¢ºèª
head blast_results.txt
```

**ã‚³ãƒãƒ³ãƒ‰è§£èª¬**:

- `makeblastdb`: FASTAãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰BLASTãŒæ¤œç´¢ã§ãã‚‹å½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚
    
- `blastn`: å¡©åŸºé…åˆ—åŒå£«ã‚’æ¯”è¼ƒã™ã‚‹BLASTæ¤œç´¢ã§ã™ã€‚
    
- `-outfmt 6`: çµæœã‚’ã‚¿ãƒ–åŒºåˆ‡ã‚Šã®ã‚·ãƒ³ãƒ—ãƒ«ãªå½¢å¼ã§å‡ºåŠ›ã—ã¾ã™ã€‚è¦‹ã‚„ã™ãã€å¾Œç¶šã®å‡¦ç†ã§æ‰±ã„ã‚„ã™ã„ã§ã™ã€‚å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®2åˆ—ç›®ã«ã€ãƒ’ãƒƒãƒˆã—ãŸã‚ãªãŸã®ã‚¢ã‚»ãƒ³ãƒ–ãƒªå†…ã®ã‚³ãƒ³ãƒ†ã‚£ã‚°åãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
    

---

### ã‚¹ãƒ†ãƒƒãƒ—3ï¼šrDNAã‚³ãƒ³ãƒ†ã‚£ã‚°é…åˆ—ã®æŠ½å‡º

BLASTã®çµæœã‹ã‚‰ã€rDNAã‚’å«ã‚€ã‚³ãƒ³ãƒ†ã‚£ã‚°ã®åå‰ã‚’ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—ã—ã€ãã®ã‚³ãƒ³ãƒ†ã‚£ã‚°ã®å®Œå…¨ãªå¡©åŸºé…åˆ—ã‚’ã‚¢ã‚»ãƒ³ãƒ–ãƒªå…¨ä½“ã‹ã‚‰æŠ½å‡ºã—ã¾ã™ã€‚

Bash

```
# 1. BLASTçµæœã®2åˆ—ç›®ï¼ˆãƒ’ãƒƒãƒˆã—ãŸã‚³ãƒ³ãƒ†ã‚£ã‚°åï¼‰ã‚’æŠ½å‡ºã—ã€é‡è¤‡ã‚’é™¤ã„ã¦ãƒªã‚¹ãƒˆåŒ–
cut -f2 blast_results.txt | sort -u > rdna_contig_names.txt

# 2. samtoolsã§ã‚¢ã‚»ãƒ³ãƒ–ãƒªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹åŒ–
samtools faidx ragtag_polished_round1.fasta

# 3. ãƒªã‚¹ãƒˆã«ã‚ã‚‹åå‰ã®ã‚³ãƒ³ãƒ†ã‚£ã‚°é…åˆ—ã‚’ã™ã¹ã¦æŠ½å‡ºã™ã‚‹
xargs samtools faidx ragtag_polished_round1.fasta < rdna_contig_names.txt > rdna_contigs.fasta

# 4. æŠ½å‡ºã•ã‚ŒãŸFASTAãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª
head rdna_contigs.fasta
```

**ã‚³ãƒãƒ³ãƒ‰è§£èª¬**:

- `cut -f2 | sort -u`: ã‚¿ãƒ–åŒºåˆ‡ã‚Šãƒ•ã‚¡ã‚¤ãƒ«ã®2åˆ—ç›®ã ã‘ã‚’åˆ‡ã‚Šå‡ºã—ã€ä¸¦ã¹æ›¿ãˆã¦é‡è¤‡ã‚’å‰Šé™¤ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€rDNAãŒä¹—ã£ã¦ã„ã‚‹ã‚³ãƒ³ãƒ†ã‚£ã‚°ã®åå‰ãƒªã‚¹ãƒˆãŒä½œæˆã•ã‚Œã¾ã™ã€‚
    
- `samtools faidx`: FASTAãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹åŒ–ã—ã€ç‰¹å®šã®é…åˆ—ã‚’é«˜é€Ÿã«æŠ½å‡ºã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚
    
- `xargs samtools faidx ...`: `rdna_contig_names.txt` ã«æ›¸ã‹ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚£ã‚°åã‚’ä¸€ã¤ãšã¤`samtools faidx`ã«æ¸¡ã—ã€è©²å½“ã™ã‚‹é…åˆ—ã‚’ã™ã¹ã¦æŠ½å‡ºã—ã¦`rdna_contigs.fasta`ã«å‡ºåŠ›ã—ã¾ã™ã€‚
    

---

### ã‚¹ãƒ†ãƒƒãƒ—4ï¼šæœ«ç«¯ã®åå¾©é…åˆ—ã®è§£æ

æœ€å¾Œã«ã€æŠ½å‡ºã—ãŸrDNAã‚³ãƒ³ãƒ†ã‚£ã‚° (`rdna_contigs.fasta`) ã®æœ«ç«¯é ˜åŸŸã«ã€ç‰¹å¾´çš„ãª(G+A)ãƒªãƒƒãƒãªåå¾©é…åˆ—ãŒã‚ã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚ã“ã‚Œã«ã¯**Tandem Repeats Finder (TRF)**ã‚’ä½¿ç”¨ã™ã‚‹ã®ãŒæœ€ã‚‚ç¢ºå®Ÿã§ã™ã€‚

Bash

```
# TRFã‚’å®Ÿè¡Œã—ã¦ã€æŠ½å‡ºã—ãŸrDNAã‚³ãƒ³ãƒ†ã‚£ã‚°å†…ã®åå¾©é…åˆ—ã‚’æ¤œå‡º
# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ä¸€èˆ¬çš„ãªã‚‚ã®ã§ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã«å¿œã˜ã¦èª¿æ•´ãŒå¿…è¦ãªå ´åˆãŒã‚ã‚Šã¾ã™ã€‚
trf rdna_contigs.fasta 2 7 7 80 10 50 500 -f -d -m

# TRFã¯è¤‡æ•°ã®å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚
# æœ€ã‚‚é‡è¦ãªã®ã¯ ".dat" ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚
less rdna_contigs.fasta.2.7.7.80.10.50.500.dat
```

**ã‚³ãƒãƒ³ãƒ‰è§£èª¬ã¨çµæœã®è§£é‡ˆ**:

- `trf`: Tandem Repeats Finderã®å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚
    
- `2 7 7 80 10 50 500`: ãƒãƒƒãƒã€ãƒŸã‚¹ãƒãƒƒãƒã€ã‚¤ãƒ³ãƒ‡ãƒ«ã®ã‚¹ã‚³ã‚¢ã‚„ã€æ¤œå‡ºã™ã‚‹åå¾©ã®æœ€å°ã‚¹ã‚³ã‚¢ãªã©ã‚’æŒ‡å®šã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã™ã€‚
    
- `-f -d -m`: å‡ºåŠ›å½¢å¼ãªã©ã‚’æŒ‡å®šã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚
    
- **`.dat` ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª**: ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ã€æ¤œå‡ºã•ã‚ŒãŸå-å¾©é…åˆ—ã®ä½ç½®ã€é•·ã•ã€ã‚³ãƒ³ã‚»ãƒ³ã‚µã‚¹é…åˆ—ãªã©ãŒè¡¨å½¢å¼ã§ã¾ã¨ã‚ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚
    
    - **è¦‹ã‚‹ã¹ããƒã‚¤ãƒ³ãƒˆ**:
        
        1. `Sequence:` ã®è¡Œã§ã‚³ãƒ³ãƒ†ã‚£ã‚°åã‚’ç¢ºèªã—ã¾ã™ã€‚
            
        2. `Indices:` ã®åˆ—ã§ã€åå¾©é…åˆ—ã®é–‹å§‹ä½ç½®ã¨çµ‚äº†ä½ç½®ã‚’ç¢ºèªã—ã¾ã™ã€‚**é–‹å§‹ä½ç½®ãŒ1ã«è¿‘ã„ã‚‚ã®**ï¼ˆã‚³ãƒ³ãƒ†ã‚£ã‚°ã®å…ˆé ­ï¼‰ã‚„ã€**çµ‚äº†ä½ç½®ãŒã‚³ãƒ³ãƒ†ã‚£ã‚°ã®å…¨é•·ã«è¿‘ã„ã‚‚ã®**ï¼ˆã‚³ãƒ³ãƒ†ã‚£ã‚°ã®æœ«å°¾ï¼‰ã‚’æ¢ã—ã¾ã™ã€‚
            
        3. `Consensus pattern:` ã®åˆ—ã§ã€ãã®åå¾©é…åˆ—ã®å˜ä½ã¨ãªã‚‹é…åˆ—ã‚’ç¢ºèªã—ã¾ã™ã€‚_Dictyostelium_ã®å ´åˆã€(G+A)ã«å¯Œã‚€é…åˆ—ï¼ˆä¾‹ï¼š`AG`, `AAG`, `AAAG`ãªã©ï¼‰ãŒè¦‹ã¤ã‹ã‚‹ã¯ãšã§ã™ã€‚
            

ã“ã®æ‰‹é †ã«ã‚ˆã‚Šã€ã‚ãªãŸã®ã‚¢ã‚»ãƒ³ãƒ–ãƒªãƒ‡ãƒ¼ã‚¿ã«ãŠã‘ã‚‹rDNAã®æœ«ç«¯åå¾©é…åˆ—ã‚’ç‰¹å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚










---
# ä»¥é™ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–


## ğŸ§¬ã‚²ãƒãƒ ã‚¢ã‚»ãƒ³ãƒ–ãƒªã‹ã‚‰ãƒ†ãƒ­ãƒ¡ã‚¢ç¹°ã‚Šè¿”ã—é…åˆ—ã‚’æ¢ç´¢ãƒ»åŒå®šã™ã‚‹ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

### ã¯ã˜ã‚ã«

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€ã‚²ãƒãƒ ã‚¢ã‚»ãƒ³ãƒ–ãƒªãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æœªçŸ¥ã®ãƒ†ãƒ­ãƒ¡ã‚¢ç¹°ã‚Šè¿”ã—é…åˆ—ã‚’æ¢ç´¢ã—ã€ãã®å€™è£œé…åˆ—ãŒæœ¬å½“ã«ãƒ†ãƒ­ãƒ¡ã‚¢ã§ã‚ã‚‹ã‹ã‚’æ¤œè¨¼ã™ã‚‹ãŸã‚ã®ä¸€é€£ã®æ¨™æº–çš„ãªæ‰‹é †ã‚’ã¾ã¨ã‚ãŸã‚‚ã®ã§ã™ã€‚ã“ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¯ã€ãƒ„ãƒ¼ãƒ«ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³äº’æ›æ€§ã®å•é¡Œã‚’å›é¿ã—ã€å …ç‰¢ã«å‹•ä½œã™ã‚‹ã‚ˆã†æœ€é©åŒ–ã•ã‚Œã¦ã„ã¾ã™ã€‚

### ğŸ”¬ å¿…è¦ãƒ„ãƒ¼ãƒ«

ã“ã®è§£æã«ã¯ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«ãŒå¿…è¦ã§ã™ã€‚äº‹å‰ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãŠã„ã¦ãã ã•ã„ã€‚

  * **seqkit**: é«˜é€ŸãªFASTA/Qæ“ä½œãƒ„ãƒ¼ãƒ«
  * **bedtools**: ã‚²ãƒãƒ é ˜åŸŸã®æ“ä½œãƒ„ãƒ¼ãƒ«
  * **Tandem Repeats Finder (TRF)**: ç¸¦åˆ—åå¾©é…åˆ—ã®æ¢ç´¢ãƒ„ãƒ¼ãƒ«
  * **bowtie2**: é«˜é€Ÿãªãƒªãƒ¼ãƒ‰ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«
  * **samtools**: SAM/BAMãƒ•ã‚¡ã‚¤ãƒ«ã®æ“ä½œãƒ„ãƒ¼ãƒ«
  * **IGV (Integrative Genomics Viewer)**: (ä»»æ„) çµæœã‚’å¯è¦–åŒ–ã™ã‚‹ãŸã‚ã®ã‚²ãƒãƒ ãƒ–ãƒ©ã‚¦ã‚¶

-----

## âœ… è§£æãƒ•ãƒ­ãƒ¼

### ã‚¹ãƒ†ãƒƒãƒ—1ï¼šæŸ“è‰²ä½“æœ«ç«¯é…åˆ—ã®æŠ½å‡º

ã‚²ãƒãƒ å…¨ä½“ã®FASTAãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã€å„æŸ“è‰²ä½“ï¼ˆã¾ãŸã¯Scaffoldï¼‰ã®ä¸¡ç«¯10kbã®é…åˆ—ã‚’æŠ½å‡ºã—ã¾ã™ã€‚ã“ã“ã§ã¯`bedtools`ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€ç¢ºå®ŸãªæŠ½å‡ºã‚’è¡Œã„ã¾ã™ã€‚

#### 1\. å„é…åˆ—ã®é•·ã•æƒ…å ±ã‚’å–å¾—ã™ã‚‹

`seqkit`ã‚’ä½¿ã„ã€FASTAãƒ•ã‚¡ã‚¤ãƒ«å†…ã®å„é…åˆ—ã®IDã¨é•·ã•ã‚’å–å¾—ã—ã¾ã™ã€‚`-i`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§IDã‚’æœ€åˆã®ç©ºç™½ã¾ã§ã§åˆ‡ã‚Šå‡ºã™ã®ãŒé‡è¦ã§ã™ã€‚

```bash
seqkit fx2tab -n -l -i your_genome.fasta > lengths.txt
```

#### 2\. æŠ½å‡ºé ˜åŸŸã®åº§æ¨™ãƒ•ã‚¡ã‚¤ãƒ« (BEDå½¢å¼) ã‚’ä½œæˆã™ã‚‹

`lengths.txt`ã‚’å…ƒã«ã€å„é…åˆ—ã®å…ˆé ­10kbã¨æœ«å°¾10kbã®åº§æ¨™æƒ…å ±ã‚’`awk`ã§ç”Ÿæˆã—ã¾ã™ã€‚

```bash
awk 'BEGIN{OFS="\t"} {
    len=$2;
    end_len=10000;
    if (len > 0) print $1, 0, (len > end_len ? end_len : len);
    if (len > end_len) {
        start = len - end_len;
        print $1, start, len;
    }
}' lengths.txt > regions.bed
```

#### 3\. é…åˆ—ã‚’æŠ½å‡ºã™ã‚‹

`bedtools getfasta`ã‚’ä½¿ã„ã€`regions.bed`ã§æŒ‡å®šã•ã‚ŒãŸé ˜åŸŸã®é…åˆ—ã‚’ã‚²ãƒãƒ ã‹ã‚‰ä¸€æ‹¬ã§æŠ½å‡ºã—ã¾ã™ã€‚

```bash
bedtools getfasta -fi your_genome.fasta -bed regions.bed -fo telomere_ends.fasta
```

ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã®å®Œäº†å¾Œã€ã™ã¹ã¦ã®æœ«ç«¯é…åˆ—ãŒ`telomere_ends.fasta`ã¨ã„ã†ä¸€ã¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

-----

### ã‚¹ãƒ†ãƒƒãƒ—2ï¼šå€™è£œã¨ãªã‚‹ç¹°ã‚Šè¿”ã—é…åˆ—ã®æ¢ç´¢

æŠ½å‡ºã—ãŸæœ«ç«¯é…åˆ—ã®ä¸­ã‹ã‚‰ã€ã‚¿ãƒ³ãƒ‡ãƒ ãƒªãƒ”ãƒ¼ãƒˆï¼ˆç¸¦åˆ—åå¾©é…åˆ—ï¼‰ã‚’`TRF`ã‚’ä½¿ã£ã¦ç¶²ç¾…çš„ã«æ¢ç´¢ã—ã¾ã™ã€‚

```bash
trf telomere_ends.fasta 2 7 7 80 10 50 500 -d -h
```

-----

### ã‚¹ãƒ†ãƒƒãƒ—3ï¼šæœ€æœ‰åŠ›å€™è£œã®åŒå®š

`TRF`ã®å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ« (`.dat`) ã¯éå¸¸ã«å¤§ãã„ã“ã¨ãŒã‚ã‚‹ãŸã‚ã€ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã£ã¦**ã‚³ãƒ”ãƒ¼æ•°ãŒæœ€ã‚‚å¤šã„ç¹°ã‚Šè¿”ã—é…åˆ—**ã‚’åŠ¹ç‡çš„ã«è¦‹ã¤ã‘å‡ºã—ã¾ã™ã€‚

```bash
grep -v -e "Sequence:" -e "Parameters:" telomere_ends.fasta.*.dat \
| awk '{print "Copy#:", $4, "\tPeriod:", $3, "\tConsensus:", $14}' \
| sort -k2 -nr \
| head -n 20
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã®å‡ºåŠ›ãƒªã‚¹ãƒˆã®æœ€ä¸Šä½ã«è¡¨ç¤ºã•ã‚Œã‚‹ã€**ã‚³ãƒ”ãƒ¼æ•°ãŒçªå‡ºã—ã¦å¤šãã€ã‹ã¤å˜ç´”ãªãƒ‘ã‚¿ãƒ¼ãƒ³**ã®é…åˆ—ãŒã€ãƒ†ãƒ­ãƒ¡ã‚¢é…åˆ—ã®æœ€æœ‰åŠ›å€™è£œã¨ãªã‚Šã¾ã™ã€‚ï¼ˆä¾‹ï¼š`(TAA)n`ãªã©ï¼‰

-----

### ã‚¹ãƒ†ãƒƒãƒ—4ï¼šã‚²ãƒãƒ å…¨ä½“ã§ã®åˆ†å¸ƒã«ã‚ˆã‚‹æœ€çµ‚æ¤œè¨¼

æœ€æœ‰åŠ›å€™è£œã¨ãªã£ãŸé…åˆ—ãŒã€æœ¬å½“ã«ãƒ†ãƒ­ãƒ¡ã‚¢ã§ã‚ã‚‹ã‹ï¼ˆæŸ“è‰²ä½“æœ«ç«¯ã«ã®ã¿å­˜åœ¨ã™ã‚‹ã‹ï¼‰ã‚’`bowtie2`ã«ã‚ˆã‚‹ãƒãƒƒãƒ”ãƒ³ã‚°ã§æœ€çµ‚ç¢ºèªã—ã¾ã™ã€‚

#### 1\. æ¤œç´¢ç”¨ã®é…åˆ—ï¼ˆã‚¯ã‚¨ãƒªï¼‰ã‚’ä½œæˆã™ã‚‹

å€™è£œé…åˆ—ï¼ˆä¾‹ï¼š`TAA`ï¼‰ã‚’è¤‡æ•°å›ç¹°ã‚Šè¿”ã—ãŸFASTAãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

```bash
# ä¾‹ï¼šå€™è£œãŒTAAã®å ´åˆ
CANDIDATE="TAA"
echo -e ">telomere_candidate_${CANDIDATE}\n$(for i in {1..15}; do echo -n $CANDIDATE; done)" > candidate_query.fasta
```

#### 2\. ã‚²ãƒãƒ å…¨ä½“ã¸ã®ãƒãƒƒãƒ”ãƒ³ã‚°

`bowtie2`ã‚’ä½¿ã„ã€å€™è£œé…åˆ—ãŒã‚²ãƒãƒ ä¸Šã®ã©ã“ã«å­˜åœ¨ã™ã‚‹ã‹ã‚’ç¶²ç¾…çš„ã«æ¤œç´¢ã—ã¾ã™ã€‚

```bash
# ã‚²ãƒãƒ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ä½œæˆï¼ˆåˆå›ã®ã¿ï¼‰
bowtie2-build your_genome.fasta genome_index

# ãƒãƒƒãƒ”ãƒ³ã‚°ã®å®Ÿè¡Œ
bowtie2 -x genome_index -f candidate_query.fasta -k 10000 --very-sensitive-local -S telomere_hits.sam
```

#### 3\. å¯è¦–åŒ–ç”¨ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®å¤‰æ›

ãƒãƒƒãƒ”ãƒ³ã‚°çµæœã‚’`samtools`ã§ã‚½ãƒ¼ãƒˆãƒ»ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹åŒ–ã—ã€ã‚²ãƒãƒ ãƒ–ãƒ©ã‚¦ã‚¶ã§è¡¨ç¤ºã§ãã‚‹å½¢å¼ã«ã—ã¾ã™ã€‚

```bash
samtools view -bS telomere_hits.sam | samtools sort -o telomere_hits.sorted.bam
samtools index telomere_hits.sorted.bam
```

### çµè«–ã¨çµæœã®è§£é‡ˆ

æœ€çµ‚çš„ã«ç”Ÿæˆã•ã‚ŒãŸ`telomere_hits.sorted.bam`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã€`IGV`ãªã©ã®ã‚²ãƒãƒ ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚²ãƒãƒ ã‚¢ã‚»ãƒ³ãƒ–ãƒªã¨ä¸€ç·’ã«è¡¨ç¤ºã—ã¾ã™ã€‚

ãƒãƒƒãƒ”ãƒ³ã‚°ã•ã‚ŒãŸãƒ’ãƒƒãƒˆï¼ˆãƒªãƒ¼ãƒ‰ï¼‰ãŒã€**ã‚²ãƒãƒ ã®ã™ã¹ã¦ã®æŸ“è‰²ä½“ï¼ˆã¾ãŸã¯é•·ã„Scaffoldï¼‰ã®æœ«ç«¯éƒ¨åˆ†ã«ã ã‘ç‰¹ç•°çš„ã«é›†ä¸­ã—ã¦ã„ã‚Œã°ã€ãã®å€™è£œé…åˆ—ãŒçœŸã®ãƒ†ãƒ­ãƒ¡ã‚¢é…åˆ—ã§ã‚ã‚‹ã¨çµè«–ã§ãã¾ã™ã€‚**

```bash
samtools view telomere_hits.sorted.bam | \
awk '
  BEGIN {
    # ã¾ãšæœ€åˆã«ã€å„Scaffoldã®å…¨é•·ã‚’ lengths.txt ã‹ã‚‰èª­ã¿è¾¼ã‚“ã§è¨˜æ†¶ã™ã‚‹
    while ((getline < "lengths.txt") > 0) {
      len_map[$1] = $2
    }
    # æœ«ç«¯é ˜åŸŸã®å¹…ã‚’10kbã«è¨­å®š
    margin = 10000
    print "Scaffold_ID\tSTART_HITS\tMIDDLE_HITS\tEND_HITS"
  }
  {
    # BAM/SAMãƒ•ã‚¡ã‚¤ãƒ«ã®3åˆ—ç›®(Scaffold ID)ã¨4åˆ—ç›®(ãƒãƒƒãƒ”ãƒ³ã‚°é–‹å§‹ä½ç½®)ã‚’å¤‰æ•°ã«æ ¼ç´
    scaffold = $3
    position = $4
    total_len = len_map[scaffold]

    # ãƒãƒƒãƒ”ãƒ³ã‚°ä½ç½®ã«å¿œã˜ã¦ã€å„é ˜åŸŸã®ãƒ’ãƒƒãƒˆæ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒƒãƒ—
    if (position <= margin) {
      start_hits[scaffold]++
    } else if (position >= total_len - margin) {
      end_hits[scaffold]++
    } else {
      middle_hits[scaffold]++
    }
  }
  END {
    # æœ€å¾Œã«ã€é›†è¨ˆçµæœã‚’Scaffoldã”ã¨ã«å‡ºåŠ›
    for (scaffold in len_map) {
      printf "%s\t%d\t%d\t%d\n", scaffold, start_hits[scaffold]+0, middle_hits[scaffold]+0, end_hits[scaffold]+0
    }
  }
'
```

