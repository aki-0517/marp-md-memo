ご提示の統計情報、ありがとうございます。Flyeでアセンブルされた11本のコンティグの中から、_Dictyostelium discoideum_（社会性アメーバ）のrDNA（リボソームDNA）コンティグを特定するには、いくつかのバイオインフォマティクス的なアプローチが必要です。統計データだけでは断定できませんが、アセンブリの出力ファイルを用いることで、高い確度で特定することが可能です。

有力な方法は主に以下の3つです。

### 1. リードカバレッジ（深度）を確認する

これが**最も一般的で確実な方法**です。

- **原理:** rDNAはゲノム内に非常に多くのコピーが存在するリピート配列です。そのため、シーケンスした際にこの領域に由来するリード（DNA断片）の数が、他のゲノム領域（染色体など）に比べて突出して多くなります。アセンブルされたコンティグのカバレッジ（リードがどれだけ積み重なったかを示す指標）を計算すると、rDNAコンティグは異常に高い値を示します。
    
- **手順:**
    
    1. アセンブリに使用したロングリード（NanoporeやPacBioのデータ）を、Flyeが出力した11本のコンティグ配列（通常 `assembly.fasta` のようなファイル名）に対してマッピングします。（使用ツール例: `Minimap2`）
        
    2. マッピング結果のBAMファイルから、各コンティグの平均カバレッジを計算します。（使用ツール例: `samtools depth`, `mosdepth`）
        
    3. 11本のコンティグのカバレッジを比較し、他のコンティグよりも桁違いに高いカバレッジを持つものがrDNAコンティグである可能性が極めて高いです。
        

---

### 2. 既知のrDNA配列との相同性検索（BLAST）

rDNA配列は生物種間で比較的よく保存されています。これを利用して特定する方法です。

- **原理:** 他の真核生物で既に同定されているrDNA配列（18S, 5.8S, 28S rRNA遺伝子など）を使って、Flyeのアセンブリ結果の中に似た配列がないか探します。
    
- **手順:**
    
    1. NCBIなどの公共データベースから、近縁種またはモデル生物のrDNA配列を取得します。
        
    2. Flyeが出力した11本のコンティグ配列に対して、取得したrDNA配列をクエリとして**BLASTn**検索を実行します。
        
    3. 非常に高いスコアでヒットしたコンティグが、rDNAコンティグの候補です。
        

---

### 3. コンティグの長さと構造を調べる

これは補助的な方法ですが、_D. discoideum_特有の性質から有効な場合があります。

- **原理:** _D. discoideum_のrDNAは、6本の染色体とは独立した、染色体外の巨大な**パリンドローム（回文）構造**のDNAとして存在することが知られています。このDNAのサイズは約88 kbです。
    
- **手順:**
    
    1. Flyeが出力した11本のコンティグそれぞれの長さを確認します。
        
    2. コンティグの中に、約88 kb、またはその半分（約44 kb）、あるいはアセンブリのエラーで断片化した長さのものが含まれていないか探します。
        
    3. また、Flyeはアセンブリグラフ（`assembly_graph.gfa`）を出力します。Bandageのようなツールでこのグラフを可視化すると、rDNAリピートは他の線状の染色体コンティグとは異なり、複雑なループや円環状の構造として描画されることがあります。
        

### まとめ

まずは**方法1（リードカバレッジの確認）** を試すことを強くお勧めします。これが最も明確な結果をもたらすでしょう。次に**方法2（BLAST検索）** でその結果を裏付けるのが王道のアプローチです。方法3は、これらの結果を補強する情報として役立ちます。

これらの解析を行うことで、11本のコンティグの中からrDNAに相当するものを高い信頼性で特定できるはずです。



指定されたファイルを使用して、FlyeアセンブリからrDNAコンティグを特定するための具体的な手順をコマンドライン操作としてまとめます。

最も確実な**リードカバレッジ（深度）による特定**を主軸に、**BLASTによる相同性検索**で確認する、という2段階のワークフローを提案します。

---

### 必要なツールの準備

まず、解析に必要なツールをインストールします。`conda` (または `mamba`) を使ったインストールが簡単です。

Bash

```
# 推奨: mambaを使うと高速にインストールできます
conda install -c bioconda mamba
mamba create -n rdna_finder -c bioconda minimap2 samtools mosdepth blast

# 作成した環境を有効化
conda activate rdna_finder
```

---

## ステップ1：リードカバレッジによるrDNAコンティグの特定

rDNAはゲノム内でコピー数が非常に多いため、シーケンスリードがマッピングされる深さ（カバレッジ）が他の染色体領域に比べて突出して高くなります。この性質を利用して特定します。

**作業ディレクトリに移動してから以下のコマンドを実行してください。**

### 1. リードをアセンブリにマッピングする

アセンブリに使用したロングリード (`Dicty_gDNA_NEB-2.fastq`) を、アセンブリ後のFASTAファイル (`ragtag_polished_round1.fasta`) にマッピングします。`Minimap2` を使用します。

Bash

```
# -t 8 は使用するスレッド数（CPUコア数）です。環境に合わせて調整してください。
# -ax map-ont はNanoporeのリードをマッピングするためのプリセットです。
minimap2 -ax map-ont \
  -t 8 \
  assembly2/assembly-results/ragtag_flye_scaffold/ragtag_polished_round1.fasta \
  /home/aki/Dicty_gDNA_NEB-2.fastq > alignment.sam
```

- `alignment.sam` というマッピング結果ファイルが生成されます。
    

### 2. マッピング結果を処理する

`samtools` を使い、SAMファイルをソート済みのBAM形式に変換し、インデックスを作成します。これは後続の解析で必須の処理です。

Bash

```
# SAM -> BAM変換とソートを同時に行う
samtools sort -@ 8 -o sorted_alignment.bam alignment.sam

# ソート済みBAMファイルにインデックスを作成
samtools index sorted_alignment.bam
```

- `sorted_alignment.bam` と `sorted_alignment.bam.bai` というファイルが生成されます。
    

### 3. 各コンティグのカバレッジを計算する

`mosdepth` を使い、各コンティグの平均カバレッジを高速に計算します。

Bash

```
# --threads 8 は使用スレッド数です。
mosdepth --threads 8 rdna_coverage sorted_alignment.bam
```

- `rdna_coverage.mosdepth.summary.txt` という要約ファイルが生成されます。
    

### 4. 結果を確認してrDNAコンティグを特定する

生成されたサマリーファイルの中身を確認します。

Bash

```
cat rdna_coverage.mosdepth.summary.txt
```

**出力例:**

```
#chrom	length	bases	mean	min	max
contig_1	12197133	1207516167	99.0	0	253
contig_2	8060236	797963364	99.0	0	248
...
contig_6	88500	1761150000	19900.0	8000	35000  <-- rDNA候補
...
contig_11	4157	411543	99.0	0	210
```

この結果で、`mean`（平均カバレッジ）の列に注目してください。**他のコンティグと比べて桁違いに（数十倍〜数百倍以上）高い数値を示しているコンティグ**が、rDNAコンティグです。上の例では `contig_6` がそれに該当します。

---

## ステップ2：BLASTによる相同性検索（確認作業）

ステップ1で特定した候補が本当にrDNAであるかを確認するため、既知のrDNA配列と照合します。

### 1. リファレンスrDNA配列を準備する

NCBIから_Dictyostelium discoideum_のrDNA配列を取得します。例えば、アクセッション番号 `M11132.1` が利用できます。これを `ref_rDNA.fasta` というファイル名で保存します。

### 2. BLASTデータベースを作成する

自分のアセンブリファイルから、BLAST検索用のデータベースを作成します。

Bash

```
makeblastdb -in assembly2/assembly-results/ragtag_flye_scaffold/ragtag_polished_round1.fasta \
  -dbtype nucl \
  -out my_assembly_db
```

### 3. BLAST検索を実行する

作成したデータベースに対して、準備したリファレンスrDNA配列をクエリとして検索を実行します。

Bash

```
blastn -query ref_rDNA.fasta \
  -db my_assembly_db \
  -outfmt "6 qseqid sseqid pident length mismatch gapopen qstart qend sstart send evalue bitscore" \
  -out blast_results.tsv
```

### 4. BLAST結果を確認する

出力された `blast_results.tsv` を確認します。

Bash

```
cat blast_results.tsv
```

2列目 (`sseqid`) に、ステップ1で特定した候補コンティグ名が表示され、かつ `pident` (一致率) と `length` (アラインメント長) が高ければ、それがrDNAコンティグであることが確定します。

この2つのステップを実行することで、11本のコンティグの中からrDNAを確実に見つけ出すことができます。


```
(rdna_finder) [aki@tardis ~]$ cat rdna_coverage.mosdepth.summary.txt
chrom   length  bases   mean    min     max
NC_000895.1_RagTag_pilon        55553   1469129450      26445.55        1739    37936
NC_007087.3_RagTag_pilon        4959406 885062875       178.46  0       2113
NC_007088.5_RagTag_pilon        8060236 1534951942      190.44  0       428
NC_007089.4_RagTag_pilon        12197133        2373225224      194.57  0       54753
NC_007091.3_RagTag_pilon        5320446 982585679       184.68  1       38845
NC_007092.3_RagTag_pilon        4039478 893887284       221.29  1       7566
contig_12_pilon_pilon   61438   8697896 141.57  1       172
contig_18_pilon_pilon   4157    102084  24.56   5       35
contig_22_pilon_pilon   34918   5197302 148.84  5       210
contig_27_pilon_pilon   83844   12033241        143.52  9       176
contig_8_pilon_pilon    44473   4349123 97.79   0       311
total   34861082        8169222100      234.34  0       54753
```

この分析結果から、**`NC_000895.1_RagTag_pilon` がrDNAコンティグであると結論付けられます**。

その理由は以下の通りです。

---

### 🔬 根拠1：突出して高いリードカバレッジ

`mean`（平均カバレッジ）の列を見ると、`NC_000895.1_RagTag_pilon` の値が **`26445.55`** となっており、他のコンティグ（おおよそ `140`〜`220` の範囲）と比較して**桁違いに高い**ことがわかります。

- **rDNAコンティグ:** `26445.55`
    
- **他の染色体コンティグの平均:** 約 `180`
    

これは、rDNAコンティグのカバレッジが他のゲノム領域の**約140倍以上**であることを示しており、ゲノム内に多数のコピーが存在するrDNA配列の典型的な特徴と完全に一致します。

---

### 🧬 根拠2：コンティグ名

コンティグ名に含まれる **`NC_000895.1`** は、NCBI（米国国立生物工学情報センター）の公共データベースにおけるアクセッション番号です。この番号を検索すると、これは **"_Dictyostelium discoideum_ AX4 ribosomal DNA, complete sequence"** のものであることがわかります。

これは、スキャフォールディングツール（RagTag）が、リファレンスゲノムのrDNA配列にあなたのコンティグを対応付けたことを示しており、**これがrDNAであることを示す決定的な証拠**です。

---

### ✅ まとめ

以上の2つの強力な証拠から、`NC_000895.1_RagTag_pilon` が探していたrDNAコンティグであると断定できます。前回のステップで提案したBLAST検索を実行するまでもなく、このカバレッジデータとコンティグ名だけで特定は完了です。


解析結果に基づき、6つの染色体に相当するコンティグを特定します。

結論から言うと、**5つの染色体は明確に特定できます**が、1つはアセンブリの問題で見かけ上はリストに存在しません。

---

### ✅ 5つの特定可能な染色体

以下の5つのコンティグが、_Dictyostelium discoideum_ の染色体に相当します。

|コンティグ名|長さ (bp)|平均カバレッジ|相当する染色体|
|---|---|---|---|
|`NC_007089.4_RagTag_pilon`|12,197,133|194.57x|**染色体3**|
|`NC_007088.5_RagTag_pilon`|8,060,236|190.44x|**染色体2**|
|`NC_007091.3_RagTag_pilon`|5,320,446|184.68x|**染色体5**|
|`NC_007087.3_RagTag_pilon`|4,959,406|178.46x|**染色体1**|
|`NC_007092.3_RagTag_pilon`|4,039,478|221.29x|**染色体6**|

####【特定理由】

1. **コンティグ名:** 名前に含まれる `NC_` から始まる番号は、リファレンスゲノムの染色体アクセッション番号です。スキャフォールディングツール（RagTag）が、アセンブルしたコンティグをリファレンスゲノムと比較し、どの染色体に対応するかを判断して命名したものです。これが最も強力な証拠です。
    
2. **サイズとカバレッジ:** これらのコンティグは、rDNA（`NC_000895.1`）を除けば最も長く、数メガベース（Mb）の長さを持ちます。また、リードカバレッジもゲノム領域として妥当な範囲（約180x〜220x）に収まっており、染色体の特徴と一致します。
    

---

### ❓ 見当たらない6番目の染色体

リストを見ると、リファレンスゲノムの**染色体4（`NC_007090`）に相当するコンティグがありません**。

これは、アセンブリやスキャフォールディングの過程で以下のようなことが起きた可能性を示唆しています。

- **アセンブリの断片化:** 染色体4がうまく一つのコンティグとして繋がらず、リストの下にあるような小さなコンティグ (`contig_12` など) に断片化してしまった。
    
- **ミスアセンブリ（融合）:** 染色体4が、他の染色体コンティグと誤って連結されてしまった。例えば、`NC_007089.4` (染色体3) はリファレンス (~7.5Mb) よりもかなり大きい (12.2Mb) ため、ここに融合している可能性も考えられます。
    
- **スキャフォールド失敗:** 染色体4に相当するコンティグはアセンブルされたものの、RagTagがリファレンス上の正しい位置に対応付けられなかった。
    

現在のデータだけでは、残りの小さなコンティグ群から染色体4を再構築することは困難です。しかし、**リストアップした5つの巨大なコンティグが、染色体1, 2, 3, 5, 6であることは確実**と言えます。

# bandage

![[Pasted image 20250812153820.png]]![[Pasted image 20250812153840.png]]