いいえ、必ずしも「一番右が一番良い」とは言えません。

**結論から言うと、塩基配列レベルの正確さ、特にインデル（挿入・欠失）エラーの少なさでは、右から2番目の `pilon_polished` が最も優れた結果を出しています。**

---

### ## 各ステップでの変化の解説

この表は、ゲノムアセンブリのパイプライン（工程）に沿って、品質がどう変化したかを示しています。流れを追ってみましょう。

1.  **`raw_flye` → `medaka_round2`**
    * **主な変化**: インデル（`# indels per 100 kbp`）が395から211へと**劇的に減少**しました。
    * **意味**: これはロングリードを使った初期ポリッシュ（Medaka）が、インデルエラーの修正に非常に効果的だったことを示しています。

2.  **`medaka_round2` → `scaffold_only`**
    * **主な変化**:
        * `# contigs`（コンティグ数）が16から**11に減少**。
        * `N50`（連続性の指標）が約3.4 Mbpから**約8.1 Mbpへと飛躍的に向上**。
    * **意味**: これはスキャフォールディング（足場作り）の工程です。断片化したコンティグを繋ぎ合わせ、ゲノムの連続性が大幅に改善されたことがわかります。

3.  **`scaffold_only` → `pilon_polished`**
    * **主な変化**:
        * インデル（`# indels per 100 kbp`）が211から**109へとさらに半減**。
        * ミスマッチ（`# mismatches per 100 kbp`）もわずかに減少。
    * **意味**: これはショートリードを使ったポリッシュ（Pilon）の工程です。**インデルエラーの修正に絶大な効果を発揮**し、塩基レベルの精度が最も高まりました。

4.  **`pilon_polished` → `medaka_polished` (一番右)**
    * **主な変化**:
        * ミスマッチ（`mismatches`）が139から**136に減少し、これが全工程で最小値**です。
        * `# N's`（不明塩基）も0.29と、これが**最小値**です。
        * ⚠️ **しかし、インデル（`indels`）が109から246へと大幅に悪化（増加）しています**。

---

### ## どの結果が一番良いか？ 🏆

どちらが「良い」かは、何を最も重視するかによります。

| 評価項目 | pilon_polished (右から2番目) | medaka_polished (一番右) | 評価 |
| :--- | :--- | :--- | :--- |
| **連続性 (N50)** | 8.06 Mbp | 8.05 Mbp | ほぼ同じ (どちらも非常に良い) |
| **ミスマッチ率** | 139.15 | **136.03** | `medaka_polished` が最良 |
| **インデル率** | **109.09** | 246.06 | `pilon_polished` が圧勝 |
| **不明塩基 (N's)** | 1.26 | **0.29** | `medaka_polished` が最良 |

#### 結論と推奨

* **遺伝子予測など、コーディング領域の正確さが重要な場合**:
    インデルはフレームシフトを引き起こし、遺伝子予測に致命的な影響を与えます。そのため、**インデル率が圧倒的に低い `pilon_polished` を使うべきです。**

* **一塩基多型（SNP）の解析など、ミスマッチの少なさが重要な場合**:
    ミスマッチ率と不明塩基の少なさを重視するなら、`medaka_polished` がわずかに優れています。

**総合的に見ると、多くの生物学的解析（特に遺伝子関連）において、インデルエラーはミスマッチエラーよりも影響が大きいです。したがって、ほとんどの場合において、右から2番目の `pilon_polished` が最もバランスの取れた、利用価値の高いアセンブリ結果だと言えるでしょう。**

この統計から判断すると、**真ん中の `canu_scaffold` が最もバランスの取れた良い結果**と言えます。一番右の最終版 (`canu_medaka_polished`) は、一部の指標が悪化しています。

---

### ## 各ステップでの品質の変化

この表は、Canuを使ったアセンブリの工程ごとの品質変化を示しています。

#### 1. `canu_raw` → `canu_scaffold` (スキャフォールディング)
* ✅ **大幅に改善した点**:
    * **連続性 (N50)**: 約3.3 Mbp から **約5.6 Mbp へと劇的に向上**しました。コンティグ（断片）をうまく繋ぎ合わせられたことを示します。
    * **断片化の度合い (L50)**: アセンブリの半分を構成するコンティグ数が4から**3に減少**し、より断片化されていないゲノムになったことを示します。
* ⚠️ **少し悪化した点**:
    * **ミスマッチ**と**ミリアセンブリ**の数がわずかに増加しています。これはスキャフォールディングの際に参照ゲノムとの比較で生じることがあります。
* 🤔 **不思議な点**:
    * **インデル（`indels per 100 kbp`）**が419から**217へと大幅に減少**しています。通常、スキャフォールディングは塩基配列を修正しないため、これは予期せぬ改善です。おそらく使用したツールがギャップを埋める際にポリッシュ機能も併用したと考えられます。

**この段階の評価**: 連続性が飛躍的に向上し、最大の課題であったインデルが半減したため、**非常に成功した工程**です。

---

#### 2. `canu_scaffold` → `canu_medaka_polished` (ポリッシング)
* ✅ **改善した点**:
    * **ミスマッチ（`mismatches per 100 kbp`）**が144から**137に減少**しました。
    * **不明塩基（`N's per 100 kbp`）**が3.33から**1.31に減少**し、スキャフォールディングで生じたギャップが埋められたことを示します。
* ❌ **悪化した点**:
    * **インデル（`indels per 100 kbp`）**が217から**255へと大幅に増加**してしまいました。

**この段階の評価**: ミスマッチやギャップを修正できた一方で、遺伝子予測などに最も影響の大きい**インデルエラーを増やしてしまった**ため、手放しに「良くなった」とは言えない結果です。

---

### ## 総合的な結論 🏆

| 評価項目 | canu_raw (左) | canu_scaffold (中央) | canu_medaka_polished (右) |
| :--- | :--- | :--- | :--- |
| **連続性 (N50)** | 3.3 Mbp | **5.6 Mbp** | **5.6 Mbp** |
| **ミスマッチ率** | **125.02** | 144.76 | 137.57 |
| **インデル率** | 419.22 | **217.17** | 255.48 |

**真ん中の `canu_scaffold` が最も推奨される結果です。**

その理由は、ゲノムアセンブリにおいて非常に重要な**「連続性（N50）」が最も高く**、かつ、遺伝子機能の解析に致命的な影響を与えうる**「インデル率」が最も低い**からです。

一番右の `canu_medaka_polished` は、最後のポリッシュ工程でインデルを増やしてしまっており、改善しようとして一部の品質を損なってしまった例と言えます。