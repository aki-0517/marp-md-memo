反復配列（リピート領域）は、ゲノムアセンブリの“落とし穴”になることが多い重要な要素です。上で示した連続性（N50 など）や精度（ミスマッチ・インデル率）、BUSCO、ゲノムカバレッジは、あくまで“全体”の指標なので、リピート領域の扱いまでは直接評価していません。以下のような手順で、反復配列を別に考慮してみることをおすすめします。

---

## 1. 反復配列って何？

* **種類**：衛星DNA、トランスポゾン（LINE/SINE/LTR）、マイクロサテライトなど
* **問題点**：似た配列がゲノム中に多数存在するため、アセンブリの際に「どこにつなげるべきか」があいまいになりやすい

---

## 2. 反復配列を評価する手順例

1. **リピーターマスキング（RepeatMasker）**

   * まずアセンブリ配列に対して RepeatMasker をかけ、どの領域が既知のリピートかラベル付けします。
   * 結果として、ゲノム中のリピートの種類・長さ・総割合（％）がわかります。

2. **リピートカバレッジの算出**

   * RepeatMasker の出力から「リピート領域全体の長さ」を集計し、アセンブリ全長に対する割合を計算。
   * 参照ゲノムでも同様に計算すれば、“過度にマスクされていないか”や “逆にリピートが欠落していないか”を比較できます。

3. **コンティグとリピートの重なり分析**

   * 各コンティグがどの程度リピート領域をまたいでいるかを調べます。
   * 例えば、長いコンティグにリピートが散在していれば「リピートをまたぐ良好なつながり」が得られていると判断できますが、リピート領域で断片化している場合は “アセンブリの難所” と言えます。

4. **LAI（LTR Assembly Index）**

   * 真核生物では LTRレトロトランスポゾンが大きなリピート成分を占めるため、LAI を計算するとアセンブリのリピート解像度が定量的に評価できます。
   * LAI≥10 なら “高品質なリピートアセンブリ” とされることが多いです。

5. **Misassembly のチェック**

   * QUAST や MUMmer を使い、参照ゲノムとのアライメントで “リピート領域での不整合”（逆向き配置、過大/過小コピーなど）を可視化・集計します。
   * SyRI などで構造バリアントを検出すると、リピートによる誤配置や欠落が詳しくわかります。

---

## 3. ツール・コマンド例

```bash
# 1) RepeatMasker でマスキング
RepeatMasker -species "dictyostelium discoideum" assembly.fasta

# 2) マスクレポートから割合を集計（簡易例）
grep "^Total interspersed" *.out

# 3) QUAST で misassemblies 確認
quast.py assembly.fasta -R reference.fna --eukaryote

# 4) LAI 計算（GenomeTools の LTR_retriever を利用）
LTR_retriever -genome assembly.fasta -inharvest harvest.out
```

---

### ポイントまとめ

* **既存指標だけでは不十分**：N50 や BUSCO はリピート特有の問題を隠すことがある
* **マスクと可視化が第一歩**：どれだけリピートを拾えているか、逆に欠落しているかを確認
* **LAI や misassembly カウント**：リピートをまたいだ連続性・正確性をより詳細に評価

まずは RepeatMasker でマスク→レポート確認、QUAST/MUMmer で misassembly を可視化、必要に応じて LAI を算出、という流れで解析してみてください。これで「リピート配列をどれだけ正確につなげられているか」がクリアになります。



### exec
```bash
RepeatMasker \
  -species "dictyostelium discoideum" \
  -pa 8 \
  -xsmall \
  /home/aki/assembly2/assembly-results/flye/assembly.fasta
```
